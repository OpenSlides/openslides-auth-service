name: CI

on: [push, pull_request]
jobs:
  build-and-test-dev-image:
    runs-on: ubuntu-latest
    steps:
      - name: Install git && openssl
        run: sudo apt-get install git openssl

      # - uses: actions/checkout@v2
      #   with:
      #     repository: OpenSlides/openslides-datastore-service

      # - name: Build datastore
      #   run: make run-dev

      # - uses: actions/checkout@v2
      # - name: Build docker prod image
      #   run: make build-prod

      # - name: Build docker dev image
      #   run: make build-dev

      # - name: Start datastore-reader-dev--service
      #   id: docker_datastore-reader
      #   uses: docker/build-push-action@v2
      #   with:
      #     context: "https://github.com/OpenSlides/openslides-datastore-service.git"
      #     file: Dockerfile
      #     args:
      #       MODULE: "reader"
      #       PORT: "9010"

      # - name: Start datastore-writer-dev--service
      #   id: docker_datastore-writer
      #   uses: docker/build-push-action@v2
      #   with:
      #     context: "https://github.com/OpenSlides/openslides-datastore-service.git"
      #     file: Dockerfile
      #     args:
      #       MODULE: "writer"
      #       PORT: "9011"

      - uses: actions/checkout@v2
      - name: Build the stack
        run: docker-compose -f "docker-compose.dev.yml" up -d
