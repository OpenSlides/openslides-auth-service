version: "3"

services:
  auth:
    image: openslides-auth
    depends_on:
      - redis
    env_file: ../../services.env
    ports:
      - "9004:9004"
    secrets:
      - auth_token_key
      - auth_cookie_key
      - internal_auth_password
      - postgres_password

  postgres:
    image: postgres:15
    environment:
      - POSTGRES_USER=openslides
      - POSTGRES_PASSWORD=openslides
      - POSTGRES_DB=openslides

  redis:
    image: redis:alpine
    expose:
      - 6379

secrets:
  auth_token_key:
    file: ./secrets/auth_token_key
  auth_cookie_key:
    file: ./secrets/auth_cookie_key
  internal_auth_password:
    file: ./secrets/internal_auth_password
  postgres_password:
    file: ./secrets/postgres_password
